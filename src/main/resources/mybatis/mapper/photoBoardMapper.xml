<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.toyproject.springsecurity.photoBoard.model.dao.PhotoBoardMapper">

    <resultMap id="photoBoardResultMap" type="PhotoBoardDTO">
        <id property="no" column="NO"/>
        <result property="title" column="TITLE"/>
        <result property="contents" column="CONTENTS"/>
        <result property="count" column="COUNT"/>
        <result property="registTime" column="REGIST_TIME"/>
        <result property="writer" column="WRITER"/>
        <result property="updateTime" column="UPDATE_TIME"/>
        <result property="deleteYn" column="DELETE_YN"/>
    </resultMap>

    <resultMap id="photoBoardFileResultMap" type="PhotoBoardFileDTO">
        <id property="fileNo" column="FILE_NO"/>
        <result property="boardNo" column="BOARD_NO"/>
        <result property="orgFileName" column="ORG_FILENAME"/>
        <result property="changeFileName" column="CHANGE_FILENAME"/>
        <result property="fileSize" column="FILE_SIZE"/>
        <result property="registTime" column="REGIST_TIME"/>
        <result property="deleteYn" column="DELETE_YN"/>
        <result property="filePath" column="FILE_PATH"/>
    </resultMap>

    <insert id="photoBoardInsert">
        INSERT
          INTO PHOTO_BOARD
        (
          NO
        , TITLE
        , CONTENTS
        , COUNT
        , REGIST_TIME
        , WRITER
        , UPDATE_TIME
        , DELETE_YN
        )
        VALUES
        (
          SEQ_PHOTOBOARD_NO.NEXTVAL
        , #{ title }
        , #{ contents }
        , 0
        , TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS')
        , #{ writer }
        , DEFAULT
        , DEFAULT
        )
    </insert>

    <insert id="photoBoardFileInsert">
<!--        <selectKey keyProperty="photoBoardNo" order="BEFORE" resultType="_int">-->
<!--            SELECT-->
<!--                    SEQ_PHOTOBOARD_NO.CURRVAL-->
<!--              FROM DUAL-->
<!--        </selectKey>-->
        INSERT
          INTO PHOTO_BOARD_FILE
        (
          FILE_NO
        , BOARD_NO
        , ORG_FILENAME
        , CHANGE_FILENAME
        , FILE_SIZE
        , REGIST_TIME
        , DELETE_YN
        , FILE_PATH
        )
        VALUES
        (
          SEQ_PHOTO_FILE_NO.NEXTVAL
        , SEQ_PHOTOBOARD_NO.CURRVAL
        , #{ orgFileName }
        , #{ changeFileName }
        , #{ fileSize }
        , TO_CHAR(SYSDATE, 'YYYY-MM-DD HH24:MI:SS')
        , DEFAULT
        , #{ filePath }
        )
    </insert>
</mapper>